var ReportsOnMap=function(){"use strict";function e(){$("#report-search-form").submit()}function t(){["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"].forEach(function(e){document.addEventListener(e,function(){a.resize()})})}function o(){var e=$("#map-report-list");0===e.length||$(window).width()<1200||(e.css("overflow-y","scroll"),e.height($(window).height()-300))}function n(){if(l(),c(),$("#map").html()){o(),t();var e=window.reportsOnMapInitData.center;a=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[e.lng,e.lat],zoom:17}),a.addControl(new mapboxgl.FullscreenControl),d(),p(),m(),$(".marker").on("click",function(){window.open($(this).data("href"),"_blank")}),a.addControl(new mapboxgl.NavigationControl,"bottom-right"),window.reportsOnMapInitData.isHomeReferrer&&MobileDetect.any()&&a.on("load",function(){$(".button-show_me-mobile").click()})}}var a,i=[],r='<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="32px" height="32px" viewBox="0 0 72 72" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <title>map-poi</title> <desc>Created with Sketch.</desc> <defs> <path d="M25.5,50.6 C39.5832611,50.6 51,39.2728042 51,25.3 C51,11.3271958 39.5832611,0 25.5,0 C11.4167389,0 0,11.3271958 0,25.3 C0,39.2728042 11.4167389,50.6 25.5,50.6 Z M25.5,33.7333333 C30.1944204,33.7333333 34,29.9576014 34,25.3 C34,20.6423986 30.1944204,16.8666667 25.5,16.8666667 C20.8055796,16.8666667 17,20.6423986 17,25.3 C17,29.9576014 20.8055796,33.7333333 25.5,33.7333333 Z" id="path-1"></path> <mask id="mask-2" maskContentUnits="userSpaceOnUse" maskUnits="objectBoundingBox" x="-3" y="-3" width="57" height="56.6"> <rect x="-3" y="-3" width="57" height="56.6" fill="white"></rect> <use xlink:href="#path-1" fill="black"></use> </mask> </defs> <g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="Jarokelo_icons_poi"> <g id="POI" transform="translate(11.000000, 3.000000)"> <circle id="Oval" fill="#FFFFFF" cx="25.5" cy="25.5" r="8.5"></circle> <g id="Combined-Shape"> <use fill="#000000" fill-rule="evenodd" xlink:href="#path-1"></use> <use stroke-opacity="0.2" stroke="#000000" mask="url(#mask-2)" stroke-width="6" xlink:href="#path-1"></use> </g> <path d="M35.8714776,48.4197347 C44.7859045,44.4772896 51,35.608643 51,25.3 C51,11.3271958 39.5832611,0 25.5,0 C11.167389,0 0,11.3271958 0,25.3 C0,35.608643 6.21409547,44.4772896 15.1285224,48.4197347 L25.5,69 L35.8714776,48.4197347 Z M25.5,33.7333333 C30.1944204,33.7333333 34,29.9576014 34,25.3 C34,20.6423986 30.1944204,16.8666667 25.5,16.8666667 C20.8055796,16.8666667 17,20.6423986 17,25.3 C17,29.9576014 20.8055796,33.7333333 25.5,33.7333333 Z" id="Combined-Shape" fill="{{ color }}"></path> </g> </g> </g> </svg>';mapboxgl.accessToken=window.mapboxToken;var s=function(e){a.setZoom(16),a.panTo(i[e].marker.getLngLat())},l=function(){$(".map-search-form-location").each(function(e,t){new google.maps.places.Autocomplete(t,{types:["address"],componentRestrictions:{country:"hu"}})})},c=function(){var t=$("#map-search-form-location-mobile");$(".button-show_me-mobile").on("click",function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(o){var n=o.coords.longitude,a=o.coords.latitude,i=new google.maps.Geocoder;i.geocode({location:{lng:n,lat:a}},function(o,n){n===google.maps.GeocoderStatus.OK&&o[0]&&o[0].formatted_address&&(t.val(o[0].formatted_address),e())})})}),t.on("change",function(){e()}),$(".button-show_me-mobile--clear").click(function(o){o.preventDefault(),t.val(""),e()})},d=function(){$(".reportsonmap").find(".card").click(function(e){var t=$(e.target||e.srcElement||e.originalTarget);t.attr("href")||(e.preventDefault(),s($(this).data("id")))})},m=function(){var e=new mapboxgl.LngLatBounds;i.forEach(function(t){e.extend(t.marker.getLngLat())}),a.fitBounds(e,{padding:100})},p=function(){$(".reportsonmap").find(".card").each(function(){var e=$(this),t=e.find(".badge").css("background-color"),o=document.createElement("img"),n=e.data("id");i[n]={},site.Helper.isIE()?(o.src="https://maps.gstatic.com/mapfiles/api-3/images/autocomplete-icons_hdpi.png",o.style.backgroundColor=t,o.style.width="22px",o.style.height="42px"):(o.src="data:image/svg+xml;charset=UTF-8;base64,"+btoa(r.replace("{{ color }}",t)),o.style.width="32px",o.style.height="32px"),o.title=e.find("h3").text(),o.dataset.href=e.find("h3").find("a").attr("href"),o.className="marker",i[n].marker=new mapboxgl.Marker(o).setLngLat([parseFloat(e.attr("data-lng")),parseFloat(e.attr("data-lat"))]),i[n].marker.addTo(a)})};return{initMap:n}}();